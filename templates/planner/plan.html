<!-- C:\Users\ASUS\MyanmarTravelPlanner\templates\planner\plan.html -->
{% extends 'base.html' %}
{% load static %}
{% block title %}Plan Your Trip - GoMyanmar{% endblock %}

{% block content %}
<div class="container py-5 mt-5">
    <div class="row">
        <div class="col-lg-8 mx-auto">
            <div class="card-glass p-4 mb-4">
                <div class="text-center mb-5">
                    <h1 class="where-next-title mb-3">Where to next?</h1>
                    <p class="lead text-gray">Choose your departure and destination for your perfect Myanmar adventure</p>
                </div>
            </div>
            
            <!-- Trip Planner Form -->
            <div class="card-glass p-5" id="start-planning">
                <h2 class="section-title mb-4">Plan Your Perfect Myanmar Adventure</h2>
                <p class="text-gray mb-5">Fill in your travel details below</p>
                
                <form method="post" id="tripForm">
                    {% csrf_token %}
                    
                    <!-- Origin and Destination Fields -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="mb-4">
                                <label class="form-label fw-bold">Departure From</label>
                                <div class="position-relative">
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="fas fa-map-marker-alt"></i>
                                        </span>
                                        <input type="text" class="form-control" name="origin" id="origin" 
                                               placeholder="Type 'M' for Mandalay, 'Y' for Yangon, etc."
                                               autocomplete="off" value="{{ origin_input }}">
                                    </div>
                                    <div id="originSuggestions" class="suggestions-dropdown"></div>
                                    <input type="hidden" id="origin_id" name="origin_id" value="{{ selected_origin_id }}">
                                </div>
                                <div class="form-text">
                                    Start typing to see suggestions (e.g., Yangon, Mandalay, Naypyidaw)
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-4">
                                <label class="form-label fw-bold">Destination To</label>
                                <div class="position-relative">
                                    <div class="input-group">
                                        <span class="input-group-text">
                                            <i class="fas fa-flag-checkered"></i>
                                        </span>
                                        <input type="text" class="form-control" name="destination" id="destination" 
                                               placeholder="Where do you want to go?"
                                               autocomplete="off" value="{{ destination_input }}">
                                    </div>
                                    <div id="destinationSuggestions" class="suggestions-dropdown"></div>
                                    <input type="hidden" id="destination_id" name="destination_id" value="{{ selected_destination_id }}">
                                </div>
                                <div class="form-text">
                                    Start typing (e.g., 'B' for Bagan, 'I' for Inle Lake, 'M' for Mandalay)
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="mb-4">
                                <label class="form-label fw-bold">Start Date</label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-calendar-alt"></i>
                                    </span>
                                    <input type="date" class="form-control" name="start_date" id="start_date" 
                                           value="{{ today }}">
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-4">
                                <label class="form-label fw-bold">End Date</label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-calendar-alt"></i>
                                    </span>
                                    <input type="date" class="form-control" name="end_date" id="end_date"
                                           value="{{ tomorrow }}">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="mb-4">
                                <label class="form-label fw-bold">Number of Travelers</label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-users"></i>
                                    </span>
                                    <select class="form-select" name="travelers" id="travelers">
                                        <option value="1" {% if travelers == 1 %}selected{% endif %}>1 Person</option>
                                        <option value="2" {% if travelers == 2 or not travelers %}selected{% endif %}>2 People</option>
                                        <option value="3" {% if travelers == 3 %}selected{% endif %}>3 People</option>
                                        <option value="4" {% if travelers == 4 %}selected{% endif %}>4 People</option>
                                        <option value="5" {% if travelers == 5 %}selected{% endif %}>5 People</option>
                                        <option value="6" {% if travelers == 6 %}selected{% endif %}>6+ People</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row mb-5">
                        <div class="col-md-6">
                            <div class="mb-4">
                                <label class="form-label fw-bold">Accommodation Type</label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-hotel"></i>
                                    </span>
                                    {% if selected_hotel_id %}
                                    <div class="form-control p-3 selection-made">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <i class="fas fa-check-circle text-success me-2"></i>
                                                <span id="selectedHotelName">{{ selected_hotel_name }}</span>
                                            </div>
                                            <button type="button" class="btn btn-sm btn-outline-secondary" id="changeHotelBtn">
                                                Change
                                            </button>
                                        </div>
                                    </div>
                                    <input type="hidden" id="selected_hotel_id" name="selected_hotel_id" value="{{ selected_hotel_id }}">
                                    {% else %}
                                    <div class="form-control p-0">
                                        <a href="#" id="selectHotelBtn" class="btn btn-link w-100 text-start p-3 text-decoration-none" style="pointer-events: none; opacity: 0.5;">
                                            <i class="fas fa-hotel me-2"></i>Select Hotels
                                            <span class="float-end"><i class="fas fa-chevron-right"></i></span>
                                        </a>
                                    </div>
                                    <input type="hidden" id="selected_hotel_id" name="selected_hotel_id">
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="mb-4">
                                <label class="form-label fw-bold">Transportation Preference</label>
                                <div class="input-group">
                                    <span class="input-group-text">
                                        <i class="fas fa-bus"></i>
                                    </span>
                                    {% if selected_transport_id %}
                                    <div class="form-control p-3 selection-made">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <i class="fas fa-check-circle text-primary me-2"></i>
                                                <span id="selectedTransportName">{{ selected_transport_name }}</span>
                                            </div>
                                            <button type="button" class="btn btn-sm btn-outline-secondary" id="changeTransportBtn">
                                                Change
                                            </button>
                                        </div>
                                    </div>
                                    <input type="hidden" id="selected_transport_type" name="selected_transport_type" value="{{ selected_transport_type }}">
                                    <input type="hidden" id="selected_transport_id" name="selected_transport_id" value="{{ selected_transport_id }}">
                                    {% else %}
                                    <div class="form-control p-0">
                                        <a href="#" id="selectTransportBtn" class="btn btn-link w-100 text-start p-3 text-decoration-none" style="pointer-events: none; opacity: 0.5;">
                                            <i class="fas fa-car me-2"></i>Select Transport
                                            <span class="float-end"><i class="fas fa-chevron-right"></i></span>
                                        </a>
                                    </div>
                                    <input type="hidden" id="selected_transport_type" name="selected_transport_type">
                                    <input type="hidden" id="selected_transport_id" name="selected_transport_id">
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary btn-lg" id="continueBtn" {% if not selected_hotel_id or not selected_transport_id %}disabled{% endif %}>
                            Continue to Plan Selection <i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </form>
                
                <!-- Clear Form Button -->
                <div class="text-center mt-4">
                    <button type="button" class="btn btn-outline-secondary" id="clearFormBtn">
                        <i class="fas fa-redo me-2"></i>Clear Form & Start Over
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const originInput = document.getElementById('origin');
        const originIdInput = document.getElementById('origin_id');
        const originSuggestions = document.getElementById('originSuggestions');
        
        const destinationInput = document.getElementById('destination');
        const destinationIdInput = document.getElementById('destination_id');
        const destinationSuggestions = document.getElementById('destinationSuggestions');
        
        const startDate = document.getElementById('start_date');
        const endDate = document.getElementById('end_date');
        const travelersSelect = document.getElementById('travelers');
        const selectHotelBtn = document.getElementById('selectHotelBtn');
        const selectTransportBtn = document.getElementById('selectTransportBtn');
        const changeHotelBtn = document.getElementById('changeHotelBtn');
        const changeTransportBtn = document.getElementById('changeTransportBtn');
        const selectedHotelId = document.getElementById('selected_hotel_id');
        const selectedTransportId = document.getElementById('selected_transport_id');
        const selectedTransportType = document.getElementById('selected_transport_type');
        const continueBtn = document.getElementById('continueBtn');
        const clearFormBtn = document.getElementById('clearFormBtn');
        const tripForm = document.getElementById('tripForm');
        
        // ========== RESTORE FORM VALUES FROM CONTEXT ==========
        if ('{{ origin_input|escapejs }}' && '{{ origin_input|escapejs }}' !== '') {
            originInput.value = '{{ origin_input|escapejs }}';
            originInput.classList.add('is-valid');
        }
        
        if ('{{ selected_origin_id }}' && '{{ selected_origin_id }}' !== '') {
            originIdInput.value = '{{ selected_origin_id }}';
        }
        
        if ('{{ destination_input|escapejs }}' && '{{ destination_input|escapejs }}' !== '') {
            destinationInput.value = '{{ destination_input|escapejs }}';
            destinationInput.classList.add('is-valid');
        }
        
        if ('{{ selected_destination_id }}' && '{{ selected_destination_id }}' !== '') {
            destinationIdInput.value = '{{ selected_destination_id }}';
        }
        
        // Set travelers
        if ('{{ travelers }}' && '{{ travelers }}' !== '') {
            travelersSelect.value = '{{ travelers }}';
        }
        
        // Set today and tomorrow from context
        if ('{{ today }}' && '{{ today }}' !== '') {
            startDate.value = '{{ today }}';
        }
        
        if ('{{ tomorrow }}' && '{{ tomorrow }}' !== '') {
            endDate.value = '{{ tomorrow }}';
        }
        
        // If no dates set, use defaults
        if (!startDate.value) {
            const today = new Date().toISOString().split('T')[0];
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const tomorrowStr = tomorrow.toISOString().split('T')[0];
            
            startDate.value = today;
            endDate.value = tomorrowStr;
        }
        
        // Date validation
        const today = new Date().toISOString().split('T')[0];
        startDate.min = today;
        endDate.min = today;
        
        startDate.addEventListener('change', function() {
            endDate.min = this.value;
            if (endDate.value && endDate.value < this.value) {
                endDate.value = this.value;
            }
            updateContinueButton();
        });
        
        endDate.addEventListener('change', updateContinueButton);
        travelersSelect.addEventListener('change', updateContinueButton);
        
        // ========== AUTOCOMPLETE FUNCTIONS ==========
        async function searchLocations(query) {
            try {
                const response = await fetch(`/planner/search-destinations/?q=${encodeURIComponent(query)}`);
                const data = await response.json();
                
                if (!data.results || data.results.length === 0) {
                    if (query.length > 1) {
                        const firstLetter = query[0].toUpperCase();
                        const secondResponse = await fetch(`/planner/search-destinations/?q=${firstLetter}`);
                        const secondData = await secondResponse.json();
                        return secondData.results || [];
                    }
                }
                return data.results || [];
            } catch (error) {
                console.error('Error searching locations:', error);
                return [];
            }
        }
        
        function setupAutocomplete(inputElement, idInput, suggestionsDiv, fieldName) {
            let debounceTimer;
            
            inputElement.addEventListener('input', async function() {
                clearTimeout(debounceTimer);
                const query = this.value.trim();
                
                if (query.length < 1) {
                    suggestionsDiv.style.display = 'none';
                    idInput.value = '';
                    updateContinueButton();
                    return;
                }
                
                debounceTimer = setTimeout(async () => {
                    const results = await searchLocations(query);
                    
                    if (results.length > 0) {
                        const exactMatches = results.filter(r => 
                            r.name.toLowerCase().startsWith(query.toLowerCase())
                        );
                        const partialMatches = results.filter(r => 
                            !r.name.toLowerCase().startsWith(query.toLowerCase())
                        );
                        const sortedResults = [...exactMatches, ...partialMatches];
                        
                        suggestionsDiv.innerHTML = sortedResults.map(dest => `
                            <div class="suggestion-item" data-id="${dest.id}" data-name="${dest.name}">
                                <div class="city-name">${dest.name}</div>
                                <div class="region-name">${dest.region} â€¢ ${dest.type}</div>
                            </div>
                        `).join('');
                        
                        suggestionsDiv.style.display = 'block';
                        
                        suggestionsDiv.querySelectorAll('.suggestion-item').forEach(item => {
                            item.addEventListener('click', function() {
                                inputElement.value = this.getAttribute('data-name');
                                idInput.value = this.getAttribute('data-id');
                                suggestionsDiv.style.display = 'none';
                                inputElement.classList.add('is-valid');
                                
                                validateLocations();
                                updateContinueButton();
                            });
                        });
                    } else {
                        suggestionsDiv.innerHTML = `
                            <div class="suggestion-item text-gray p-3">
                                No locations found. Try: Yangon, Mandalay, Bagan, Inle Lake, Naypyidaw
                            </div>`;
                        suggestionsDiv.style.display = 'block';
                    }
                }, 250);
            });
        }
        
        // Setup autocomplete for both fields
        setupAutocomplete(originInput, originIdInput, originSuggestions, 'origin');
        setupAutocomplete(destinationInput, destinationIdInput, destinationSuggestions, 'destination');
        
        // Hide suggestions when clicking outside
        document.addEventListener('click', function(e) {
            if (!originInput.contains(e.target) && !originSuggestions.contains(e.target)) {
                originSuggestions.style.display = 'none';
            }
            if (!destinationInput.contains(e.target) && !destinationSuggestions.contains(e.target)) {
                destinationSuggestions.style.display = 'none';
            }
        });
        
        // ========== VALIDATION FUNCTIONS ==========
        function validateLocations() {
            const originId = originIdInput.value;
            const destinationId = destinationIdInput.value;
            
            if (originId && destinationId && originId === destinationId) {
                alert('Departure and destination cannot be the same. Please choose different locations.');
                destinationInput.value = '';
                destinationIdInput.value = '';
                destinationInput.classList.remove('is-valid');
                return false;
            }
            return true;
        }
        
        function updateContinueButton() {
            const hasOrigin = originIdInput.value.trim() !== '';
            const hasDestination = destinationIdInput.value.trim() !== '';
            const hasHotel = selectedHotelId && selectedHotelId.value;
            const hasTransport = selectedTransportId && selectedTransportId.value;
            const hasDates = startDate.value && endDate.value;
            
            const areDifferent = hasOrigin && hasDestination && originIdInput.value !== destinationIdInput.value;
            
            // Enable/disable hotel selection button
            if (selectHotelBtn) {
                if (areDifferent && hasDates) {
                    selectHotelBtn.style.pointerEvents = 'auto';
                    selectHotelBtn.style.opacity = '1';
                } else {
                    selectHotelBtn.style.pointerEvents = 'none';
                    selectHotelBtn.style.opacity = '0.5';
                }
            }
            
            // Enable/disable transport selection button
            if (selectTransportBtn) {
                if (areDifferent && hasDates) {
                    selectTransportBtn.style.pointerEvents = 'auto';
                    selectTransportBtn.style.opacity = '1';
                } else {
                    selectTransportBtn.style.pointerEvents = 'none';
                    selectTransportBtn.style.opacity = '0.5';
                }
            }
            
            // Enable/disable continue button
            if (hasOrigin && hasDestination && hasHotel && hasTransport && areDifferent && hasDates) {
                continueBtn.disabled = false;
            } else {
                continueBtn.disabled = true;
            }
        }
        
        // ========== SAVE TRIP INFO FUNCTION ==========
        async function saveTripInfo() {
            return new Promise((resolve, reject) => {
                if (!validateLocations()) {
                    reject('Invalid locations');
                    return;
                }
                
                if (!originIdInput.value || !destinationIdInput.value) {
                    reject('Please select both departure and destination first.');
                    return;
                }
                
                if (!startDate.value || !endDate.value) {
                    reject('Please select travel dates first.');
                    return;
                }
                
                const formData = new FormData();
                formData.append('origin_id', originIdInput.value);
                formData.append('destination_id', destinationIdInput.value);
                formData.append('start_date', startDate.value);
                formData.append('end_date', endDate.value);
                formData.append('travelers', travelersSelect.value);
                
                // Also save hotel and transport if they exist
                if (selectedHotelId && selectedHotelId.value) {
                    formData.append('hotel_id', selectedHotelId.value);
                }
                
                if (selectedTransportId && selectedTransportId.value) {
                    formData.append('transport_id', selectedTransportId.value);
                    formData.append('transport_type', selectedTransportType.value);
                }
                
                formData.append('csrfmiddlewaretoken', document.querySelector('[name=csrfmiddlewaretoken]').value);
                
                fetch('{% url "planner:plan" %}', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Server response:', data);
                    if (data.success && data.trip_id) {
                        resolve(data.trip_id);
                    } else {
                        reject(data.error || 'Please try again.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    reject('An error occurred. Please try again.');
                });
            });
        }
        
        // ========== BUTTON EVENT HANDLERS ==========
        // Hotel selection button
        if (selectHotelBtn) {
            selectHotelBtn.addEventListener('click', async function(e) {
                e.preventDefault();
                
                try {
                    const tripId = await saveTripInfo();
                    window.location.href = `/planner/select-hotel-map/${tripId}/`;
                } catch (error) {
                    console.error('Save trip error:', error);
                    alert(error || 'An error occurred. Please try again.');
                }
            });
        }
        
        // Transport selection button
        if (selectTransportBtn) {
            selectTransportBtn.addEventListener('click', async function(e) {
                e.preventDefault();
                
                try {
                    const tripId = await saveTripInfo();
                    window.location.href = `/planner/select-transport-category/${tripId}/`;
                } catch (error) {
                    console.error('Save trip error:', error);
                    alert(error || 'An error occurred. Please try again.');
                }
            });
        }
        
        // Change Hotel button
        if (changeHotelBtn) {
            changeHotelBtn.addEventListener('click', async function(e) {
                e.preventDefault();
                
                try {
                    // Clear the current hotel selection
                    if (selectedHotelId) {
                        selectedHotelId.value = '';
                    }
                    
                    // Save trip info and redirect to hotel selection
                    const tripId = await saveTripInfo();
                    window.location.href = `/planner/select-hotel-map/${tripId}/`;
                } catch (error) {
                    console.error('Save trip error:', error);
                    alert(error || 'An error occurred. Please try again.');
                }
            });
        }
        
        // Change Transport button
        if (changeTransportBtn) {
            changeTransportBtn.addEventListener('click', async function(e) {
                e.preventDefault();
                
                try {
                    // Clear the current transport selection
                    if (selectedTransportId) selectedTransportId.value = '';
                    if (selectedTransportType) selectedTransportType.value = '';
                    
                    // Save trip info and redirect to transport selection
                    const tripId = await saveTripInfo();
                    window.location.href = `/planner/select-transport-category/${tripId}/`;
                } catch (error) {
                    console.error('Save trip error:', error);
                    alert(error || 'An error occurred. Please try again.');
                }
            });
        }
        
        // Clear Form button
        if (clearFormBtn) {
            clearFormBtn.addEventListener('click', function() {
                // Clear all form fields
                originInput.value = '';
                originIdInput.value = '';
                originInput.classList.remove('is-valid');
                
                destinationInput.value = '';
                destinationIdInput.value = '';
                destinationInput.classList.remove('is-valid');
                
                if (selectedHotelId) selectedHotelId.value = '';
                if (selectedTransportId) selectedTransportId.value = '';
                if (selectedTransportType) selectedTransportType.value = '';
                
                // Reset to default dates
                const today = new Date().toISOString().split('T')[0];
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                const tomorrowStr = tomorrow.toISOString().split('T')[0];
                
                startDate.value = today;
                endDate.value = tomorrowStr;
                
                travelersSelect.value = '2';
                
                // Update UI
                updateContinueButton();
                
                // Show message
                alert('Form cleared. You can start a new trip.');
            });
        }
        
        // ========== FORM SUBMISSION - UPDATED FOR PLAN SELECTION ==========
        tripForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!originIdInput.value) {
                alert('Please select a departure location.');
                originInput.focus();
                return false;
            }
            
            if (!destinationIdInput.value) {
                alert('Please select a destination.');
                destinationInput.focus();
                return false;
            }
            
            if (!selectedHotelId || !selectedHotelId.value) {
                alert('Please select a hotel first.');
                return false;
            }
            
            if (!selectedTransportId || !selectedTransportId.value) {
                alert('Please select transport first.');
                return false;
            }
            
            if (!validateLocations()) {
                return false;
            }
            
            // Show loading state
            const originalText = continueBtn.innerHTML;
            continueBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Processing...';
            continueBtn.disabled = true;
            
            try {
                // First, save the trip to get trip_id
                const formData = new FormData(tripForm);
                formData.append('csrfmiddlewaretoken', document.querySelector('[name=csrfmiddlewaretoken]').value);
                
                // Make AJAX request to save trip
                const response = await fetch('{% url "planner:plan" %}', {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });
                
                const data = await response.json();
                
                if (data.success && data.trip_id) {
                    // Success! Redirect to plan selection page
                    window.location.href = `/planner/trip/${data.trip_id}/plans/`;
                } else {
                    // Handle error
                    alert(data.error || 'An error occurred. Please try again.');
                    continueBtn.innerHTML = originalText;
                    continueBtn.disabled = false;
                }
                
            } catch (error) {
                console.error('Error:', error);
                alert('An error occurred. Please try again.');
                continueBtn.innerHTML = originalText;
                continueBtn.disabled = false;
            }
            
            return false;
        });
        
        // ========== INITIALIZATION ==========
        // Initial validation
        validateLocations();
        updateContinueButton();
        
        // Call updateContinueButton after a short delay to ensure DOM is ready
        setTimeout(updateContinueButton, 100);
    });
</script>

<style>
.suggestions-dropdown {
    background: white;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    max-height: 300px;
    overflow-y: auto;
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    z-index: 1000;
    margin-top: 2px;
}

.suggestion-item {
    padding: 10px 15px;
    border-bottom: 1px solid #f0f0f0;
    cursor: pointer;
    transition: background 0.2s;
}

.suggestion-item:hover {
    background: #f8f9fa;
}

.suggestion-item:last-child {
    border-bottom: none;
}

.city-name {
    font-weight: 600;
    color: #333;
    margin-bottom: 2px;
}

.region-name {
    font-size: 0.85rem;
    color: #666;
}

.selection-made {
    background: #f8f9fa;
    border-color: #dee2e6 !important;
}

/* Style for form validation */
.is-valid {
    border-color: #198754 !important;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right calc(.375em + .1875rem) center;
    background-size: calc(.75em + .375rem) calc(.75em + .375rem);
}
</style>
{% endblock %}